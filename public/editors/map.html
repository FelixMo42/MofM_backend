<!DOCTYPE html>
<html>
    <head>
        <title>MofM editor</title>
        <link rel="stylesheet" type="text/css" href="/style/main.css">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
        </script>
    </head>
    <body>
        <!-- form -->
        <form>
            <input type="text" name="id" id="id">
            <input type="submit", value="get">
        </form>
        <hr/>

        <!-- options -->
        <div id="opts">
            <div class="option">
                <label for="name">name</label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    onchange="update('name')"
                />
            </div>

            <div class="option">
                <label for="width">width</label>
                <input
                    type="number"
                    id="width"
                    name="width"
                    onchange="update('width')"
                />
            </div>
            

            <div class="option">
                <label for="height">height</label>
                <input
                    type="number"
                    id="height"
                    name="height"
                    onchange="update('height')"
                />
            </div>
        </div>

        <!-- script -->
        <script>
            let url = new URL(window.location.href)
            let id = url.searchParams.get("id")
            document.getElementById("id").value = id

            fetch(`http://localhost:3001/data/map/${id}.json`)
                .then(response => response.json())
                .then(data => {
                    for (let key in data) {
                        document.getElementById(key).value = data[key].toString()
                    }
                }
            )

            function update(key) {
                $.ajax({
                    url: `http://localhost:3001/api/map/${id}`,
                    type: "PUT",
                    contentType: "application/json",
                    data: JSON.stringify({
                        [key]: document.getElementById(key).value
                    })
                }).done(data => {
                    console.log(data)
                })
            }
        </script>
    </body>
</html>